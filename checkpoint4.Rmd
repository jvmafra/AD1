---
title: "An?lise dos gastos dos deputados"
author: "Jo?o Victor Barroso Mafra"
date: "17 de julho de 2016"
output: html_document
---


```{r}
library(dplyr, warn.conflicts = FALSE)
library(ggplot2)
library(knitr)
theme_set(theme_bw())
```


```{r}

#Carregando os arquivos dos gastos e das cotas por estado

ler_gastos <- function(arquivo){
  require("dplyr", warn.conflicts = FALSE)
  
  gastos = read.csv(arquivo, stringsAsFactors = FALSE, encoding='UTF-8')
  return(gastos)
}

gastos <- ler_gastos("dados/ano-atual.csv")
gastos = gastos %>% 
    mutate_each(funs(as.factor), sgPartido, sgUF, txNomeParlamentar, indTipoDocumento)


gastos <- gastos %>% select (1, 5, 6, 15, 23)

names(gastos) <- c("Partido", "Nome", "UF", "Tipo_despesa", "Valor_liquido")

bancada <- ler_gastos("dados/bancada.csv")
```


## Como s?o as distribui??es dos gastos por partido?

Aqui estamos interessados em saber como se comportam os gastos analisando cada partido. Partidos maiores s?o realmente os que mais gastam? H? uma diferen?a muita grande entre gastos de cada partido? Interessante perceber que aqui, faremos uma m?dia do gasto de todos deputados dos principais partidos, com o objetivo de manter a propor??o. Analisando dados brutos, temos que o PMDB ? o partido que mais gasta pelo ?bvio motivo de ter mais deputados na bancada

```{r}
#agrupa_estado <- gastos %>% group_by(UF, Cota) %>% summarise(media = sum(Valor_liquido))

agrupa_partido <- gastos %>% group_by(Partido) %>% summarise(total = sum(Valor_liquido))


partidos <- merge(agrupa_partido, bancada)


ggplot(partidos, aes(x= Partido, y = total/Numero)) + geom_bar(stat = "identity") + coord_flip() + ylab("M?dia de gasto por deputado") + xlab("Partido")

ggplot(partidos, aes(x = Partido, y = total/Numero)) + geom_point() + coord_flip()

agrupa_nome <- gastos %>% group_by(Nome, Partido) %>% summarise(total = sum(Valor_liquido))

ggplot(agrupa_nome, aes(x = Partido, y = total)) + geom_point() + coord_flip()
#Nova pergunta: Analisar fornecedores dos gastos com atividade parlamentar
# Analisar deputados que mais gastam nas coisas menos comuns

```